# CVE-2025-29628: Cleartext Transmission of IoT Hub Credentials

## Advisory

| Field | Value |
|-------|-------|
| **CVE** | CVE-2025-29628 |
| **ICSA** | [ICSA-26-055-03](https://www.cisa.gov/news-events/ics-advisories/icsa-26-055-03) |
| **CVSS 3.1** | 8.3 (High) |
| **Vector** | `CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L` |
| **CWE** | CWE-319 (Cleartext Transmission of Sensitive Information) |
| **Researcher** | Gr0m |
| **Published** | 2026-02-24 |

## Product

| Field | Value |
|-------|-------|
| Vendor | Gardyn |
| Product | Gardyn Home Kit 1.0, 2.0, 3.0; Gardyn Studio 1.0, 2.0 |
| Component | Device firmware, mobile application |
| Affected Versions | Firmware < master.619, Mobile App < 2.11.0, Cloud API < 2.12.2026 |

## Summary

The Gardyn Home Kit transmits Azure IoT Hub connection strings and WiFi credentials over unencrypted HTTP connections, making credentials vulnerable to interception through Man-in-the-Middle attacks.

## Vulnerability Details

### Device Pairing over HTTP

During device setup, the Gardyn device broadcasts an open WiFi network (`Gardyn-XXXX`) with no encryption. The mobile application sends WiFi credentials to the device via HTTP POST to `http://192.168.4.1:8010/`. The pairing flow also provisions the device with its Azure IoT Hub connection string over this unencrypted channel.

An attacker within radio range during setup can:
- Join the open `Gardyn-XXXX` network (no password required)
- Sniff HTTP traffic on port 8010
- Capture the victim's home WiFi SSID and passphrase in plaintext
- Capture or modify the IoT Hub connection string

Intercepted pairing data:
```json
{
  "ssid": "VictimHomeWiFi",
  "password": "SuperSecretPassword123"
}
```

One-time capture grants permanent access to the victim's home network.

### Cleartext HTTP API Endpoints

The mobile application communicates with internal API servers over unencrypted HTTP:

| Endpoint | Purpose | Data Exposed |
|----------|---------|-------------|
| `http://[REDACTED — internal IP]:3000/api/journal` | Photo timeline metadata | Photo indexes, timestamps |
| `http://[REDACTED — internal IP]:3000/api/user_photos` | Photo file retrieval | Home interior camera images |
| `http://[REDACTED — timelapse endpoint]:3010/api/user_photos/` | Timelapse video processing | Camera images |

These endpoints are configured via Firebase Remote Config and hardcoded in the APK. Traffic includes user photos from Gardyn's built-in camera (images of home interiors), photo metadata and timestamps, and authentication tokens.

The internal Azure VM IP address (`[REDACTED — internal IP]`) is directly exposed to the mobile app — not behind a CDN or reverse proxy.

### Cleartext Traffic Enabled in Android Manifest

The Android manifest sets `android:usesCleartextTraffic="true"`, explicitly permitting unencrypted HTTP traffic for all network connections in the application.

## Impact

- Capture of Azure IoT Hub device credentials during provisioning
- Interception of home WiFi credentials during device setup
- Interception of home interior photos from Gardyn cameras (~115,000 cameras)
- Session hijacking via captured authentication tokens

## Remediation

**Recommended mitigations for device owners:**

- Set up Gardyn devices on a private, trusted network — not in public or shared spaces
- Isolate the device on a dedicated network segment
- Monitor for unexpected DNS or connection changes on the device

**Recommended fix for the vendor:**

1. Use HTTPS (TLS 1.2+) for all device-to-cloud and app-to-cloud communications
2. Implement proper X.509 certificate validation in the mobile application
3. Set `android:usesCleartextTraffic="false"` in the Android manifest
4. Implement certificate pinning for API endpoints
5. Use ECDH key exchange or WPA3-SAE for the device pairing flow
6. Migrate internal API servers to HTTPS

## Timeline

| Date | Event |
|------|-------|
| 2025-10-14 | Initial disclosure to vendor |
| 2025-12-11 | Disclosure to CERT/CC |
| 2026-01-11 | Cleartext HTTP photo endpoints confirmed active |
| 2026-02-24 | ICSA-26-055-03 published |

## References

- [CVE-2025-29628 — CVE Record](https://www.cve.org/CVERecord?id=CVE-2025-29628)
- [ICSA-26-055-03](https://www.cisa.gov/news-events/ics-advisories/icsa-26-055-03)
- [CSAF JSON](https://raw.githubusercontent.com/cisagov/CSAF/develop/csaf_files/OT/white/2026/icsa-26-055-03.json)
- [CWE-319: Cleartext Transmission of Sensitive Information](https://cwe.mitre.org/data/definitions/319.html)

## Credit

Reported by Gr0m to CISA.
