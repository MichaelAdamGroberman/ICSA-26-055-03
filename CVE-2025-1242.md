# CVE-2025-1242: Exposure of Administrative IoT Hub Credentials

## Advisory

| Field | Value |
|-------|-------|
| **CVE** | CVE-2025-1242 |
| **ICSA** | [ICSA-26-055-03](https://www.cisa.gov/news-events/ics-advisories/icsa-26-055-03) |
| **CVSS 3.1** | 9.1 (Critical) |
| **Vector** | `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N` |
| **CWE** | CWE-798 (Use of Hard-coded Credentials) |
| **Researcher** | Gr0m |
| **Published** | 2026-02-24 |

## Product

| Field | Value |
|-------|-------|
| Vendor | Gardyn |
| Product | Gardyn Home Kit 1.0, 2.0, 3.0; Gardyn Studio 1.0, 2.0 |
| Component | Cloud API, mobile application, device firmware |
| Affected Versions | Firmware < master.619, Mobile App < 2.11.0, Cloud API < 2.12.2026 |

## Summary

The Azure IoT Hub administrative credential (`iothubowner` shared access policy) is extractable through multiple vectors including unauthenticated API responses, mobile application reverse engineering, and device firmware analysis. This credential grants administrative control over the Gardyn IoT Hub, which architecturally manages all registered devices.

## Vulnerability Details

### The Credential

The `iothubowner` shared access policy is the highest-privilege credential in Azure IoT Hub. It grants:

| Permission | Description | Risk Level |
|------------|-------------|------------|
| **RegistryRead** | Read device registry (enumerate all devices) | HIGH |
| **RegistryWrite** | Modify device registry (add/delete devices) | CRITICAL |
| **ServiceConnect** | Send cloud-to-device messages | CRITICAL |
| **DeviceConnect** | Send device-to-cloud messages (impersonate any device) | CRITICAL |
| **ServiceInvoke** | Invoke direct methods on any device | CRITICAL |

Microsoft documentation states: *"The `iothubowner` policy has all permissions and should be used with extreme caution. It is intended for backend service administration only and should NEVER be distributed to clients."*

A single `iothubowner` connection string provides administrative access to the Gardyn IoT Hub.

### Exposure Vectors

The credential was exposed through multiple independent channels:

**1. Unauthenticated API endpoint**

The `/api/device/pair` endpoint returned the `hub_conn_string` field containing the `iothubowner` credential to any caller. No authentication was required. This endpoint is used during device provisioning and was accessible to anyone on the internet.

> **Request details removed** — The exact endpoint URL and request structure have been removed from this public disclosure to reduce attacker enablement.

The `hub_conn_string` field was subsequently removed from this endpoint's response (partial fix), but the endpoint still returns `device_conn_string` without authentication.

**2. Unauthenticated user enumeration endpoint**

The `/api/users` endpoint returned complete records for all 134,215 registered users without authentication. Every record included the `hub_conn_string` field — 134,215 copies of the administrative credential in a single API response.

> **Request details removed** — The exact endpoint URL has been removed from this public disclosure.

This endpoint also exposed sensitive PII for all users:

| Data Field | API Field | Risk Level |
|------------|-----------|------------|
| Full Name | `name` | HIGH |
| Email Address | `email` | HIGH |
| Phone Number | `mobile` | CRITICAL |
| CC Last 4 Digits | `last_four` | HIGH (PCI-DSS) |
| User ID | `user_id` | HIGH (sequential, enables IDOR) |
| Device ID | `device_id` | HIGH |
| Hub Connection String | `hub_conn_string` | CRITICAL |
| Device Connection String | `device_conn_string` | HIGH |

The endpoint was blocked after researcher disclosure on December 18, 2025.

**3. Mobile application**

The credential is embedded in the React Native application bundle (Hermes bytecode in `index.android.bundle`). It is also distributed via Firebase Remote Config, which logs credentials to Android logcat in debug builds.

**4. Device firmware**

The connection string is present in device firmware files under `/usr/local/etc/gardyn/` and is logged to syslog in cleartext during initialization.

### Exposure Window

The credential has been exposed since at least May 2019 (6+ years based on API endpoint availability). The vendor migrated from an earlier IoT Hub (`[REDACTED — IoT Hub name]`) to the current hub (`[REDACTED — IoT Hub name]`) but reused the same shared access key, meaning anyone who captured the credential during the original exposure window retains access.

## Impact

An attacker with the `iothubowner` credential can:

- Enumerate registered devices via IoT Hub registry queries
- Invoke direct methods on registered devices, including the `upgrade()` method vulnerable to command injection (CVE-2025-29631)
- Read and modify device twin configurations
- Send cloud-to-device messages
- Create or delete device registrations
- Access device telemetry data

Combined with CVE-2025-29631, this credential enables remote code execution as root on devices using the shared credentials (verified on researcher's own device).

## Remediation

**Recommended mitigations for device owners:**

- Isolate the Gardyn device on a dedicated VLAN or IoT network segment
- Monitor the device for unexpected network activity
- Do not place the device on networks containing sensitive systems

**Recommended fix for the vendor:**

1. Immediately rotate the `iothubowner` shared access key
2. Remove the administrative credential from all API responses, mobile application code, and Firebase Remote Config
3. Implement per-device scoped credentials using Azure IoT Hub Device Provisioning Service (DPS) with X.509 certificates
4. Require authentication on all API endpoints that return device or hub credentials
5. Audit IoT Hub access logs for unauthorized access during the exposure window
6. Implement monitoring and alerting for anomalous IoT Hub administrative operations

## Timeline

| Date | Event |
|------|-------|
| ~2019-05 | Earliest known credential exposure via API endpoints |
| 2025-10-14 | Initial disclosure to vendor |
| 2025-12-11 | Disclosure to CERT/CC |
| 2025-12-11 | `hub_conn_string` removed from `/api/device/pair` response (partial fix) |
| 2025-12-18 | `/api/users` endpoint blocked |
| 2026-01-22 | Vendor claims IoT Hub key rotation mitigates device control |
| 2026-02-24 | ICSA-26-055-03 published |

## References

- [CVE-2025-1242 — CVE Record](https://www.cve.org/CVERecord?id=CVE-2025-1242)
- [ICSA-26-055-03](https://www.cisa.gov/news-events/ics-advisories/icsa-26-055-03)
- [CSAF JSON](https://raw.githubusercontent.com/cisagov/CSAF/develop/csaf_files/OT/white/2026/icsa-26-055-03.json)
- [CWE-798: Use of Hard-coded Credentials](https://cwe.mitre.org/data/definitions/798.html)
- [Azure IoT Hub Shared Access Policies](https://learn.microsoft.com/en-us/azure/iot-hub/iot-hub-dev-guide-sas)

## Credit

Reported by Gr0m to CISA.
